---
title: union
description: union
date: 2024-010-19
---

## Union 模板

```c++
int n = 1005;
vector<int> father = vector<int> (n, 0); 

// 并查集初始化
void init() {
    for (int i = 0; i < n; ++i) {
        father[i] = i;
    }
}
// 并查集尋根過程
int find(int u) {
    return u == father[u] ? u : father[u] = find(father[u]); // 路徑壓縮
}

// 判斷 u 和 v是否找到同一個根
bool isSame(int u, int v) {
    u = find(u);
    v = find(v);
    return u == v;
}

// 將v->u 這條邊加入并查集
void join(int u, int v) {
    u = find(u); // 尋找u的根
    v = find(v); // 尋找v的根
    if (u == v) return ; // 如果發現根相同，則在一个集合，不用两個節點相連，直接返回
    father[v] = u;
}
```

## Union按rank合併

```c++
int n = 1005; // n根據題目定義，一般比節點大一點即可
vector<int> father = vector<int> (n, 0); 
vector<int> rank = vector<int> (n, 1); // 初始化每棵樹高度為1

// 并查集初始化
void init() {
    for (int i = 0; i < n; ++i) {
        father[i] = i;
        rank[i] = 1; // 可以省略
    }
}
// 并查集尋找根過程
int find(int u) {
    return u == father[u] ? u : find(father[u]);// 注意這裏不做路徑壓縮
}

// 判斷 u 和 v是否找到同一個根
bool isSame(int u, int v) {
    u = find(u);
    v = find(v);
    return u == v;
}

// 將v->u 這條邊加入并查集
void join(int u, int v) {
    u = find(u); // 尋找u的根
    v = find(v); // 尋找v的根

    if (rank[u] <= rank[v]) father[u] = v; // rank小的樹合入到rank大的樹
    else father[v] = u;

    if (rank[u] == rank[v] && u != v) rank[v]++; // 如果两棵樹高度相同，則v的高度+1，因為上面 if (rank[u] <= rank[v]) father[u] = v; 注意是 <=
}
```

## Hdu1213

- 題目要求好友關系，如果A認識B就會做一起，只需要一張桌子，現在來個C不認識自己也一張
  - 用union來將認識的合併，在統計有多少集合
- 注意題目從1開始

```c++
#include <iostream>
using namespace std;

const int N = 1050;
int s[N];

void init_set(){
    for(int i=1;i<=N;i++) s[i] = i;
}

int find_set(int x) {
    if(x != s[x]) s[x] = find_set(s[x]);
    return s[x];
}

void merge_set(int x,int y){
    x=find_set(x);y=find_set(y);
    if(x!=y)s[x]=s[y];
}

int main(){
    ios::sync_with_stdio(0);
    cin.tie(0);
    cout.tie(0);
    int t,m,n,x,y;
    cin >> t;
    while(t--){
        cin >> n >> m;
        init_set();
        for(int i=1;i<=m;i++){
            cin >> x >> y;
            merge_set(x,y);
        }
        int ans=0;
        for(int i=1;i<=n;i++){
            if(s[i]==i)ans++;
        }
        cout << ans << '\n';
    }
}
```
